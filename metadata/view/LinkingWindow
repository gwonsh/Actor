{
    "type": "Ext.window.Window",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "bodyStyle": [
            "{",
            "    'background-color':'#ffffff'",
            "}"
        ],
        "categoryId": "`''`",
        "cls": [
            "upload-form"
        ],
        "container|padding": 20,
        "designer|userAlias": "linkingwindow",
        "designer|userClassName": "LinkingWindow",
        "ghost": true,
        "height": 750,
        "hidden": null,
        "isSimple": true,
        "layout": "border",
        "maximizable": true,
        "modal": true,
        "openner": "`null`",
        "style": null,
        "title": [
            "{linkWinTitle}"
        ],
        "width": 1000
    },
    "configAlternates": {
        "title": "binding",
        "isSimple": "boolean",
        "bodyStyle": "object",
        "categoryId": "string",
        "cls": "typedarray",
        "container|padding": "auto",
        "designer|userAlias": "string",
        "designer|userClassName": "string",
        "ghost": "object",
        "height": "auto",
        "hidden": "boolean",
        "layout": "string",
        "maximizable": "boolean",
        "modal": "boolean",
        "openner": "string",
        "style": "object",
        "width": "auto"
    },
    "name": "MyWindow",
    "designerId": "602b0cfd-4b2a-482d-9435-6996b8b3e5f9",
    "customConfigs": [
        {
            "group": "(Custom Properties)",
            "name": "categoryId",
            "type": "string"
        },
        {
            "group": "(Custom Properties)",
            "name": "opener",
            "type": false
        },
        {
            "group": "(Custom Properties)",
            "name": "openner",
            "type": "string"
        },
        {
            "group": "(Custom Properties)",
            "name": "isSimple",
            "type": "string"
        }
    ],
    "viewControllerInstanceId": "3d0b04d5-4ec6-4138-81b9-437f0825989d",
    "viewModelInstanceId": "cccb63c9-e282-4acd-9917-59e936c4264e",
    "cn": [
        {
            "type": "Ext.tree.Panel",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "bodyBorder": false,
                "hideHeaders": true,
                "itemId": "tree",
                "layout|region": "west",
                "layout|split": true,
                "style": null,
                "title": [
                    "{category}"
                ],
                "width": 230
            },
            "configAlternates": {
                "title": "binding",
                "bodyBorder": "boolean",
                "hideHeaders": "boolean",
                "itemId": "string",
                "layout|region": "string",
                "layout|split": "boolean",
                "style": "object",
                "width": "auto"
            },
            "name": "MyTreePanel1",
            "designerId": "778c6051-c722-4fdd-b8da-50f9b357980c",
            "cn": [
                {
                    "type": "Ext.tree.View",
                    "reference": {
                        "name": "viewConfig",
                        "type": "object"
                    },
                    "codeClass": null,
                    "name": "MyTreeView1",
                    "designerId": "85ecaf33-0d68-4a24-a188-c513f5435694"
                }
            ]
        },
        {
            "type": "Ext.container.Container",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "itemId": "listContainer",
                "layout": "fit",
                "layout|region": "center",
                "layout|split": true,
                "style": "border:1px solid #cecece"
            },
            "configAlternates": {
                "style": "string",
                "itemId": "string",
                "layout": "string",
                "layout|region": "string",
                "layout|split": "boolean"
            },
            "name": "MyContainer14",
            "designerId": "93e018d6-e331-460a-a810-2b4dd78f556b",
            "cn": [
                {
                    "type": "Ext.grid.Panel",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "header": false,
                        "itemId": "listForLink",
                        "numOfItem": "30",
                        "title": "Data list",
                        "type": "extra"
                    },
                    "configAlternates": {
                        "header": "boolean",
                        "itemId": "string",
                        "title": "string",
                        "type": "string",
                        "numOfItem": "string"
                    },
                    "name": "MyGridPanel",
                    "designerId": "d8916433-3a06-4b02-8f27-a045ed28ff6b",
                    "customConfigs": [
                        {
                            "group": "(Custom Properties)",
                            "name": "type",
                            "type": "string"
                        },
                        {
                            "group": "(Custom Properties)",
                            "name": "numOfItem",
                            "type": "string"
                        }
                    ],
                    "cn": [
                        {
                            "type": "Ext.view.Table",
                            "reference": {
                                "name": "viewConfig",
                                "type": "object"
                            },
                            "codeClass": null,
                            "name": "MyTable",
                            "designerId": "1669cf25-ef00-41fc-a6a3-6a9d42bb3d00",
                            "cn": [
                                {
                                    "type": "Ext.grid.plugin.DragDrop",
                                    "reference": {
                                        "name": "plugins",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "ddGroup": "gridData"
                                    },
                                    "configAlternates": {
                                        "ddGroup": "string"
                                    },
                                    "name": "MyGridDragDropPlugin1",
                                    "designerId": "9bcde630-5884-466e-9b4c-524ee74be2b0"
                                }
                            ]
                        },
                        {
                            "type": "Ext.grid.column.Column",
                            "reference": {
                                "name": "columns",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "designer|displayName": "String",
                                "text": null
                            },
                            "configAlternates": {
                                "designer|displayName": "string",
                                "text": "string"
                            },
                            "name": "MyColumn1",
                            "designerId": "b4084cd3-0747-4ac7-93de-54925f9bda0e"
                        },
                        {
                            "type": "Ext.toolbar.Paging",
                            "reference": {
                                "name": "dockedItems",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "displayInfo": true,
                                "dock": "bottom",
                                "itemId": "pagingToolbar",
                                "width": null
                            },
                            "configAlternates": {
                                "displayInfo": "boolean",
                                "dock": "string",
                                "itemId": "string",
                                "width": "auto"
                            },
                            "name": "MyPagingToolbar1",
                            "designerId": "5295012d-d9d7-437d-895d-ac681943e43e",
                            "cn": [
                                {
                                    "type": "Ext.form.field.Text",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fieldLabel": "Label",
                                        "hideLabel": true,
                                        "itemId": "linkSearch",
                                        "layout|flex": null,
                                        "margin": "0 0 0 3",
                                        "width": 100
                                    },
                                    "configAlternates": {
                                        "fieldLabel": "string",
                                        "hideLabel": "boolean",
                                        "itemId": "string",
                                        "layout|flex": "number",
                                        "margin": "auto",
                                        "width": "auto"
                                    },
                                    "name": "MyTextField1",
                                    "designerId": "f3f0f3ed-5529-49d1-86ee-3eb3fd258066"
                                },
                                {
                                    "type": "Ext.button.Button",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "glyph": "xf002@FontAwesome",
                                        "itemId": "findLinkData",
                                        "layout|flex": null,
                                        "margin": "0 6 0 6",
                                        "text": null
                                    },
                                    "configAlternates": {
                                        "glyph": "auto",
                                        "itemId": "string",
                                        "layout|flex": "number",
                                        "margin": "auto",
                                        "text": "string"
                                    },
                                    "name": "MyButton4",
                                    "designerId": "5a27e87f-49ff-4f32-8f0f-28455671dcf1",
                                    "cn": [
                                        {
                                            "type": "basiceventbinding",
                                            "reference": {
                                                "name": "listeners",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "fn": "onFindLinkDataClick",
                                                "implHandler": [
                                                    "var val = button.up('pagingtoolbar').down('#linkSearch').getValue();",
                                                    "var ctrl = getController('Main');",
                                                    "var query = \"&se_all=\" + val;",
                                                    "ctrl.getServerData('', query, button.up('pagingtoolbar').up('gridpanel'));"
                                                ],
                                                "name": "click",
                                                "scope": "me"
                                            },
                                            "configAlternates": {
                                                "fn": "string",
                                                "implHandler": "code",
                                                "name": "string",
                                                "scope": "string"
                                            },
                                            "name": "onFindLinkDataClick",
                                            "designerId": "c389d419-602d-44a6-b5a4-df22c7b3d161"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "viewcontrollereventbinding",
                            "reference": {
                                "name": "listeners",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fn": "onListForLinkCellDblClick",
                                "implHandler": [
                                    "var linkWin = tableview.up('window');",
                                    "var dropBox = linkWin.down('#dropBox');",
                                    "/* check units in dropBox of linkingWindow */",
                                    "var preUnit = dropBox.down('#unit_' + record.data.bd_idx);",
                                    "/* check units in linkedData of newRequest view */",
                                    "/* newRequest를 통해 업로드하거나 수정할 때만 체크 */",
                                    "var uploadWin = linkWin.openner;",
                                    "/* if request win is opened that is new request mode or edit request mode */",
                                    "if(uploadWin && !uploadWin.hidden){",
                                    "    var oldUnit = linkWin.openner.down('#' + linkWin.getItemId() + '_unitCon').down('#unit_' + record.data.bd_idx);",
                                    "    /* check if it has been added */",
                                    "    if(oldUnit !== null || preUnit !== null){",
                                    "        Ext.toast(loc.main.duplicated);",
                                    "        return;",
                                    "    }",
                                    "}",
                                    "else{",
                                    "    /* in case edit by viewer directly */",
                                    "    if(preUnit !== null){",
                                    "        Ext.toast(loc.main.duplicated);",
                                    "        return;",
                                    "    }",
                                    "}",
                                    "",
                                    "var linkUnit = Ext.create(appName + '.view.LinkUnit', {",
                                    "    itemId:'unit_' + record.data.bd_idx",
                                    "});",
                                    "",
                                    "",
                                    "if(record.data.thumb_path){",
                                    "    linkUnit.down('#image').setStyle('background-image', 'url(' +record.data.thumb_path+ ')');",
                                    "}",
                                    "else{",
                                    "    linkUnit.down('#image').setStyle('background-image', 'url(resources/images/ico_noimage.gif');",
                                    "}",
                                    "",
                                    "linkUnit.getViewModel().setData({",
                                    "    src:record.data.thumb_path,",
                                    "    bdIdx:record.data.bd_idx,",
                                    "    unitTitle:record.data.bd_subject",
                                    "});",
                                    "dropBox.add(linkUnit);"
                                ],
                                "name": "celldblclick",
                                "scope": "me"
                            },
                            "configAlternates": {
                                "fn": "string",
                                "implHandler": "code",
                                "name": "string",
                                "scope": "string"
                            },
                            "name": "onListForLinkCellDblClick",
                            "designerId": "430f7ec1-e423-46ed-929c-5f02cdb0f1f1"
                        }
                    ]
                }
            ]
        },
        {
            "type": "Ext.panel.Panel",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "container|align": "middle",
                "height": 180,
                "itemId": "dropBox",
                "layout": "hbox",
                "layout|region": "south",
                "scrollable": true,
                "style": [
                    "{",
                    "    'background-color':'#eeeeee',",
                    "    border:'1px solid #cecece'",
                    "}"
                ],
                "title": null
            },
            "configAlternates": {
                "scrollable": "boolean",
                "container|align": "string",
                "height": "auto",
                "itemId": "string",
                "layout": "string",
                "layout|region": "string",
                "style": "object",
                "title": "string"
            },
            "name": "MyPanel3",
            "designerId": "df8e5768-46a3-4e6f-83c0-9fd90235576e",
            "cn": [
                {
                    "type": "basicfunction",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "fn": "getLinkData",
                        "implHandler": [
                            "var value;",
                            "if(!this.items) {",
                            "    value = '';",
                            "}",
                            "else{",
                            "    value = this.items.items;",
                            "}",
                            "return value;"
                        ]
                    },
                    "configAlternates": {
                        "fn": "string",
                        "implHandler": "code"
                    },
                    "name": "getLinkData",
                    "designerId": "22f7c501-7a38-4764-ba2f-fd72782a3965"
                },
                {
                    "type": "Ext.container.Container",
                    "reference": {
                        "name": "dockedItems",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "container|align": "middle",
                        "container|pack": "end",
                        "container|padding": "0 0 0 10",
                        "dock": "top",
                        "height": 35,
                        "itemId": "header",
                        "layout": "hbox",
                        "layout|flex": null
                    },
                    "configAlternates": {
                        "container|align": "string",
                        "container|pack": "string",
                        "container|padding": "auto",
                        "dock": "string",
                        "height": "auto",
                        "itemId": "string",
                        "layout": "string",
                        "layout|flex": "number"
                    },
                    "name": "MyContainer15",
                    "designerId": "eb806d9e-c511-4cc7-982d-594fa9f9f40d",
                    "cn": [
                        {
                            "type": "Ext.form.Label",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "layout|flex": 1,
                                "layout|margins": "0 0 0 8",
                                "text": [
                                    "{dropHere}"
                                ]
                            },
                            "configAlternates": {
                                "text": "binding",
                                "layout|flex": "number",
                                "layout|margins": "string"
                            },
                            "name": "MyLabel4",
                            "designerId": "5502c5c8-afd8-4b65-b78e-3700894cc588"
                        },
                        {
                            "type": "Ext.button.Button",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "itemId": "btnRestLink",
                                "layout|flex": null,
                                "text": [
                                    "{reset}"
                                ]
                            },
                            "configAlternates": {
                                "text": "binding",
                                "itemId": "string",
                                "layout|flex": "number"
                            },
                            "name": "MyButton6",
                            "designerId": "573c9aa2-415b-44df-8bbe-aa4032de9ad1",
                            "cn": [
                                {
                                    "type": "basiceventbinding",
                                    "reference": {
                                        "name": "listeners",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fn": "onButtonClick",
                                        "implHandler": [
                                            "var container = button.up('container').up('container');",
                                            "var dBox = container.queryById('dropBox');",
                                            "dBox.removeAll();"
                                        ],
                                        "name": "click",
                                        "scope": "me"
                                    },
                                    "configAlternates": {
                                        "fn": "string",
                                        "implHandler": "code",
                                        "name": "string",
                                        "scope": "string"
                                    },
                                    "name": "onButtonClick",
                                    "designerId": "988ae8e5-0fd9-4ed3-bc6b-495689f8fdf8"
                                }
                            ]
                        },
                        {
                            "type": "Ext.toolbar.Spacer",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "layout|flex": null,
                                "width": 3
                            },
                            "configAlternates": {
                                "layout|flex": "number",
                                "width": "auto"
                            },
                            "name": "MySpacer3",
                            "designerId": "8f9af105-575d-46a1-a9da-e1d084a6d0db"
                        },
                        {
                            "type": "Ext.button.Button",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "itemId": "btnSaveClose",
                                "layout|flex": null,
                                "layout|margins": null,
                                "margin": null,
                                "text": [
                                    "{saveClose}"
                                ]
                            },
                            "configAlternates": {
                                "text": "binding",
                                "itemId": "string",
                                "layout|flex": "number",
                                "layout|margins": "string",
                                "margin": "auto"
                            },
                            "name": "MyButton7",
                            "designerId": "09bd9166-fd06-44f6-ba51-71866aa46b49",
                            "cn": [
                                {
                                    "type": "basiceventbinding",
                                    "reference": {
                                        "name": "listeners",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fn": "onbtnSaveCloseClick",
                                        "implHandler": [
                                            "var dropBox = button.up('#dropBox');",
                                            "var lnkWin = dropBox.up('window');",
                                            "var uploadWin = lnkWin.openner;",
                                            "if(uploadWin){",
                                            "    /* in case upload or edit by new request */",
                                            "    var luCon = uploadWin.down('#' + lnkWin.getItemId() + '_unitCon');",
                                            "    for (var i=dropBox.getLinkData().length; i--; ) {",
                                            "        luCon.add(dropBox.getLinkData()[i]);",
                                            "    }",
                                            "    lnkWin.close();",
                                            "",
                                            "}",
                                            "else{",
                                            "    /* in case upload or edit by viewer */",
                                            "    lnkWin.fireEvent('save');",
                                            "}"
                                        ],
                                        "name": "click",
                                        "scope": "me"
                                    },
                                    "configAlternates": {
                                        "fn": "string",
                                        "implHandler": "code",
                                        "name": "string",
                                        "scope": "string"
                                    },
                                    "name": "onbtnSaveCloseClick",
                                    "designerId": "fb99fc6e-a960-4fdc-b081-86c6a9bfaa1c"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "viewcontrollereventbinding",
                    "reference": {
                        "name": "listeners",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "fn": "onDroipBoxRender",
                        "implHandler": [
                            "var dropEl = component.el.dom;",
                            "var me = component;",
                            "var dropTarget = Ext.create('Ext.dd.DropTarget', dropEl, {",
                            "    ddGroup:'gridData',",
                            "    notifyEnter:function(ddSource, e, data){",
                            "        /* hide 'drop here' message when a data dragged on dropBox */",
                            "        me.down('#header').setHtml('');",
                            "    },",
                            "    notifyDrop:function(ddSource, e, data){",
                            "        var record = ddSource.dragData.records[0];",
                            "        /* check units in dropBox of linkingWindow */",
                            "        var preUnit = me.down('#unit_' + record.data.bd_idx);",
                            "        var oldUnit = null;",
                            "        /* check units in linkedData of newRequest view */",
                            "        var uploadWin = component.up('window').openner;",
                            "        /* if request win is opened that is new request mode or edit request mode */",
                            "        if(uploadWin && !uploadWin.hidden){",
                            "            oldUnit = uploadWin.down('#' + me.up('window').getItemId()).down('#unit_' + record.data.bd_idx);",
                            "        }",
                            "        /* check if it has been added */",
                            "        if(oldUnit !== null || preUnit !== null){",
                            "            Ext.toast(loc.main.duplicated);",
                            "            return;",
                            "        }",
                            "        /* drop into dropBox the dragged data */",
                            "        var linkUnit = Ext.create(appName + '.view.LinkUnit', {",
                            "            itemId:'unit_' + record.data.bd_idx",
                            "        });",
                            "        linkUnit.getViewModel().setData({",
                            "            src:record.data.thumb_path,",
                            "            bdIdx:record.data.bd_idx,",
                            "            unitTitle:record.data.bd_subject",
                            "        });",
                            "        if(record.data.thumb_path){",
                            "            linkUnit.down('#image').setStyle('background-image', 'url(' +record.data.thumb_path+ ')');",
                            "        }",
                            "        else{",
                            "            linkUnit.down('#image').setStyle('background-image', 'url(resources/images/ico_noimage.gif');",
                            "        }",
                            "        me.add(linkUnit);",
                            "    }",
                            "});"
                        ],
                        "name": "render",
                        "scope": "me"
                    },
                    "configAlternates": {
                        "fn": "string",
                        "implHandler": "code",
                        "name": "string",
                        "scope": "string"
                    },
                    "name": "onDroipBoxRender",
                    "designerId": "2848d319-6bc5-4965-83bf-9cbb9e98156a"
                }
            ]
        },
        {
            "type": "viewcontrollereventbinding",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onWindowBeforeRender",
                "implHandler": [
                    "var tree = component.down('#tree');",
                    "tree.setTitle(loc.main.category);",
                    "var tStore = Ext.create('Ext.data.TreeStore', {",
                    "    //     model:'CateModel',",
                    "    fields:[",
                    "        {name:'title'},",
                    "        {name:'lazy'},",
                    "        /* category id to expand tree automactically when click expand icon */",
                    "        /* cateList?node = 'id' */",
                    "        {",
                    "            name:'id',",
                    "            mapping:'data.id'",
                    "        },",
                    "        {",
                    "            name:'text',",
                    "            mapping:'title'",
                    "        },",
                    "        /* check if need to show the expand icon  */",
                    "        {",
                    "            name:'leaf',",
                    "            convert:function(v, record){",
                    "                return (record.get('lazy') === false);",
                    "            }",
                    "        }",
                    "    ],",
                    "    proxy: {",
                    "        type: 'jsonp',",
                    "        reader: {",
                    "            type: 'json'",
                    "        },",
                    "        api: {",
                    "            read: getCategoryListApi()",
                    "        }",
                    "    }",
                    "});",
                    "tStore.load();",
                    "tree.setStore(tStore);",
                    "var ctrl = getController('Main');",
                    "ctrl.getServerData('', '', component.down('gridpanel'));",
                    "tree.getSelectionModel().on('select', function(sm, node, index){",
                    "    component.down('gridpanel').categoryId = node.id;",
                    "    ctrl.getServerData(node.id, '&ca_id=' + node.id, component.down('gridpanel'));",
                    "});"
                ],
                "name": "beforerender",
                "scope": "me"
            },
            "configAlternates": {
                "fn": "string",
                "implHandler": "code",
                "name": "string",
                "scope": "string"
            },
            "name": "onWindowBeforeRender",
            "designerId": "637a3c95-a200-4678-b492-0098ee5b4e80"
        }
    ]
}
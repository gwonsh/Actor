{
    "type": "Ext.container.Container",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "container|align": "stretch",
        "container|padding": null,
        "designer|userAlias": "attachunit",
        "designer|userClassName": "AttachUnit",
        "height": null,
        "itemId": null,
        "layout": "vbox",
        "margin": "0 5 5 0",
        "padding": null,
        "style": null,
        "width": 86
    },
    "configAlternates": {
        "style": "string",
        "container|padding": "auto",
        "designer|userAlias": "string",
        "designer|userClassName": "string",
        "height": "auto",
        "itemId": "string",
        "layout": "string",
        "margin": "auto",
        "padding": "auto",
        "width": "auto",
        "container|align": "string"
    },
    "name": "MyContainer10",
    "designerId": "044ba23e-3e3e-46b8-9b1e-36c76bc730e4",
    "viewControllerInstanceId": "87307dd2-3239-4f98-a527-3172d8750c72",
    "viewModelInstanceId": "00676f50-619c-420d-ba32-251a6ffab97b",
    "cn": [
        {
            "type": "Ext.container.Container",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "height": 70,
                "itemId": "imageCon",
                "layout": "column",
                "margin": "0 8 0 0",
                "padding": null,
                "style": "border:1px solid #cecece;text-align:center",
                "width": 86
            },
            "configAlternates": {
                "style": "string",
                "height": "auto",
                "itemId": "string",
                "layout": "string",
                "margin": "auto",
                "padding": "auto",
                "width": "auto"
            },
            "name": "MyContainer10",
            "designerId": "949c7a95-1d33-43a3-80a4-fe74d4ee4d90"
        },
        {
            "type": "Ext.form.Label",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "itemId": "fileName",
                "layout|flex": null,
                "margin": null,
                "style": "font-size:11px;overflow:hidden",
                "text": null
            },
            "configAlternates": {
                "style": "string",
                "itemId": "string",
                "layout|flex": "number",
                "margin": "auto",
                "text": "string"
            },
            "name": "MyLabel3",
            "designerId": "020aa94c-ed90-483a-9c52-3e83fbed4346"
        },
        {
            "type": "Ext.form.Label",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "itemId": "fileSize",
                "layout|flex": null,
                "margin": null,
                "style": "font-size:11px;overflow:hidden",
                "text": null
            },
            "configAlternates": {
                "style": "string",
                "itemId": "string",
                "layout|flex": "number",
                "margin": "auto",
                "text": "string"
            },
            "name": "MyLabel5",
            "designerId": "f63b7db8-087f-448c-867a-29152103d42d"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "file",
                    "index"
                ],
                "fn": "addFile",
                "implHandler": [
                    "var me = this;",
                    "this.file = file;",
                    "this.index = index;",
                    "var types = ['image/png', 'image/gif', 'image/jpg', 'image/jpeg'];",
                    "var me = this;",
                    "var imgStyle = {",
                    "    'background-position':'center',",
                    "    'background-repeat':'no-repeat'",
                    "};",
                    "if(types.indexOf(file.type) != -1 && file.size <50000000){",
                    "    var img = new mOxie.Image();",
                    "    imgStyle['background-size'] = 'contain';",
                    "    img.onload = function(){",
                    "        var dUrl = this.getAsDataURL();",
                    "        imgStyle['background-image'] = 'url(' + dUrl + ')';",
                    "        me.down('#imageCon').setStyle(imgStyle);",
                    "        var clrFld = me.up('form').down('#getColors');",
                    "        if(clrFld){//if getColors field exists",
                    "            if(index === 0 && clrFld.getValue() === ''){//only for the first uploaded file",
                    "                var colorsCon = me.up('form').down('#colorsCon');",
                    "                var image = document.createElement('img');",
                    "                image.addEventListener('load', function(){",
                    "                    var ct = new ColorThief();",
                    "                    var colors = getController('Config').getColorChips(image, colorsCon);",
                    "                    var cPt = JSON.stringify(colors);",
                    "                    clrFld.setValue(cPt);",
                    "                    //             var baster = RGBaster.colors(image, {",
                    "                    //                 exclude: [ 'rgb(51,204,153)' ],",
                    "                    //                 success:function(payload){",
                    "                    //                     for(var i=0;i<payload.palette.length;i++){",
                    "                    //                         var chip = {",
                    "                    //                             xtype:'component',",
                    "                    //                             width:60,",
                    "                    //                             height:60,",
                    "                    //                             style:'background-color:' + payload.palette[i]",
                    "                    //                         };",
                    "                    //                         colorsCon.add(chip);",
                    "                    //                     }",
                    "                    //                 }",
                    "                    //             });",
                    "",
                    "                    //window that for configure number of colors",
                    "//                     var nocWin = Ext.create('Ext.window.Window', {",
                    "//                         padding:20,",
                    "//                         items:[",
                    "//                             {",
                    "//                                 xtype:'label',",
                    "//                                 text:loc.upload.numOfColors",
                    "//                             },",
                    "//                             {",
                    "//                                 xtype:'container',",
                    "//                                 width:'100%',",
                    "//                                 layout:{",
                    "//                                     type:'hbox',",
                    "//                                     align:'center'",
                    "//                                 },",
                    "//                                 items:[",
                    "//                                     {",
                    "//                                         xtype:'numberfield',",
                    "//                                         width:66,",
                    "//                                         itemId:'fdColors',",
                    "//                                         value:8",
                    "//                                     },",
                    "//                                     {",
                    "//                                         xtype:'button',",
                    "//                                         text:loc.main.ok,",
                    "//                                         listeners:{",
                    "//                                             click:function(btn){",
                    "//                                                 var ct = new ColorThief();",
                    "//                                                 var colors = btn.up('window').down('#fdColors').getValue();",
                    "//                                                 var pt = ct.getPalette(image, colors);",
                    "//                                                 var cPt = JSON.stringify(pt);",
                    "//                                                 clrFld.setValue(cPt);",
                    "",
                    "//                                                 for(var i=0; i<pt.length; i++){",
                    "//                                                     var rgb = 'rgb(';",
                    "//                                                     for(var j=0; j<pt[i].length; j++){",
                    "//                                                         rgb += pt[i][j];",
                    "//                                                         if(j<2){",
                    "//                                                             rgb += ',';",
                    "//                                                         }",
                    "//                                                     }",
                    "//                                                     rgb += ')';",
                    "//                                                     var chip = {",
                    "//                                                         xtype:'component',",
                    "//                                                         width:50,",
                    "//                                                         height:50,",
                    "//                                                         style:'background-color:' + rgb",
                    "//                                                     };",
                    "//                                                     colorsCon.add(chip);",
                    "//                                                 }",
                    "//                                                 btn.up('window').close();",
                    "//                                             }",
                    "//                                         }",
                    "//                                     }",
                    "//                                 ]",
                    "//                             }",
                    "//                         ],",
                    "//                         listeners:{",
                    "//                             afterrender:function(win){",
                    "//                                 win.el.on('keyup', function(e){",
                    "//                                     if(e.keyCode == '13'){",
                    "//                                         win.down('button').fireEvent('click', win.down('button'));",
                    "//                                     }",
                    "//                                 });",
                    "//                             }",
                    "//                         }",
                    "//                     }).show();",
                    "                });",
                    "                image.setAttribute('src', dUrl);",
                    "            }",
                    "        }",
                    "    };",
                    "    img.load(file.getSource());",
                    "}",
                    "else{",
                    "    var split = file.name.split('.');",
                    "    var icoSrc = 'resources/images/ico_ext/ext_' + split[split.length - 1] + '.png';",
                    "    var errSrc = 'resources/images/ico_ext/ext_no.png';",
                    "    var icoImg = new Image();",
                    "    icoImg.src = icoSrc;",
                    "    imgStyle['background-size'] = 'auto';",
                    "    imgStyle['background-image'] = 'url(' + icoSrc + ')';",
                    "    me.down('#imageCon').setStyle(imgStyle);",
                    "    icoImg.onerror = function(){",
                    "        imgStyle['background-image'] = 'url(' + errSrc + ')';",
                    "        me.down('#imageCon').setStyle(imgStyle);",
                    "    };",
                    "}",
                    "this.down('#fileName').setText(file.name);",
                    "this.down('#fileSize').setText(getController('Viewer').autoFilesizeFormat(file.size));",
                    ""
                ]
            },
            "configAlternates": {
                "designer|params": "typedarray",
                "fn": "string",
                "implHandler": "code"
            },
            "name": "addFile",
            "designerId": "244f9838-a44b-41d8-8fdb-f086a66de9bd"
        },
        {
            "type": "viewcontrollereventbinding",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onContainerAfterRender",
                "implHandler": [
                    "component.el.on('dblclick', function(el){",
                    "    var upWin = component.up('window');",
                    "    var listCon = upWin.down('#attachCon').down('#fileList');",
                    "    var index = listCon.items.items.indexOf(component);",
                    "    //the field that was build by code \"getColors\"",
                    "    var fdColors = upWin.down('#getColors');",
                    "    if(fdColors && index === 0){",
                    "        var colorsCon = upWin.down('#colorsCon');",
                    "        var nextUnit = listCon.items.items[1];",
                    "        colorsCon.removeAll();",
                    "        if(nextUnit){//if next file is image, extract the colors",
                    "            var types = ['image/png', 'image/gif', 'image/jpg', 'image/jpeg'];",
                    "            fdColors.setValue('');",
                    "            if(types.indexOf(nextUnit.file.type) != -1){",
                    "                var img = new mOxie.Image();",
                    "                img.onload = function(){",
                    "                    var image = document.createElement('img');",
                    "                    image.addEventListener('load', function(){",
                    "                        var colors = getController('Config').getColorChips(image, colorsCon);",
                    "                        fdColors.setValue(JSON.stringify(colors));",
                    "                    });",
                    "                    image.setAttribute('src', this.getAsDataURL());",
                    "",
                    "",
                    "                };",
                    "                img.load(nextUnit.file.getSource());",
                    "            }",
                    "        }",
                    "        else{",
                    "            fdColors.setValue('');",
                    "        }",
                    "    }",
                    "",
                    "    var file = component.file;",
                    "    component.up('form').uploader.removeFile(file);",
                    "    component.destroy();",
                    "});"
                ],
                "name": "afterrender",
                "scope": "me"
            },
            "configAlternates": {
                "fn": "string",
                "implHandler": "code",
                "name": "string",
                "scope": "string"
            },
            "name": "onContainerAfterRender",
            "designerId": "17c8dec4-0a80-4bce-971c-7e77ab5c8a10"
        }
    ]
}